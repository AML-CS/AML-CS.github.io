MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:!0}}),document.addEventListener('DOMContentLoaded',function(a){for(let a=0,b=document.links,c=b.length;a<c;a++)b[a].hostname!=window.location.hostname&&(b[a].target='_blank')}),window.initWRFBaqApp=async function(){const d='https://api.github.com/repos/AML-CS/wrf-baq-0.5km',e='https://raw.githubusercontent.com/AML-CS/wrf-baq-0.5km',o=new URLSearchParams(document.location.search).get('sha')||'master';let a=1;const c={pwater:'Precipitable Water',wind:'Wind speed',temp:'Temperature',uwind:'U wind speed',vwind:'V wind speed',press:'Pressure'};function n(){const a=document.getElementById('wrf-baq-app');a.classList.remove('hide')}async function m(a){const{files:f}=await fetch(`${d}/commits/${a}`).then(a=>a.json()),g=await fetch(`${e}/${a}/output/report.json`).then(a=>a.json()),b={},c={},h=new RegExp(/output\/(.*)\..*/);return await Promise.all(f.map(async({filename:d,contents_url:g})=>{const f=h.exec(d)[1];if(d.includes('.gif')&&(b[f]=`${e}/${a}/${d}`),d.includes('.html')){const{content:a}=await fetch(g).then(a=>a.json());c[f]=`data:text/html;base64,${a}`}})),{report:g,images:b,folium:c}}async function j(a=0){const b=await fetch(`${d}/commits?page=${a}&per_page=10`).then(a=>a.json()),c=b.map(({sha:b,commit:a})=>{if(a.message.includes('BAQ 0.5km WRF output'))return{message:a.message,sha:b}}).filter(Boolean);return c}function i(a){const d=document.getElementById('report-title'),b=document.getElementById('report-data');d.innerHTML=`Report: ${a.createdAt}`,b.innerHTML='';const c={createdAt:a=>['Updated',`${a} UTC`],startDate:a=>['WRF Start Date',`${a}:00 UTC`],endDate:a=>['WRF End Date',`${a}:00 UTC`],gfsUrls:a=>[`<a href="https://registry.opendata.aws/noaa-gfs-bdp-pds/" target="_blank" rel="noopener noreferrer nofollow">NOAA - GFS data</a>`,a.map(a=>`<a href="https://noaa-gfs-bdp-pds.s3.amazonaws.com/index.html#${a}" target="_blank" rel="noopener noreferrer nofollow">${a}</a>`).join('<br>')],ogimetUrl:a=>[`<a href="https://www.ogimet.com/home.phtml.en" target="_blank" rel="noopener noreferrer nofollow">OGIMET</a> query`,`<a href="${a}" target="_blank" rel="noopener noreferrer nofollow">${a}</a>`],ogimetStationCoordinates:a=>['SKBQ station',`<a href="https://www.google.com/maps/place/${a.join(',')}" target="_blank" rel="noopener noreferrer nofollow" >${a.join(',')}</a>`],interpolatedVariables:a=>['Interpolated variables',a.join('<br>').replace(/:fcst(.*?):from [0-9]+/g,'')]};Object.entries(a).forEach(([d,g])=>{const a=document.createElement('tr'),e=document.createElement('td'),f=document.createElement('td');if(d in c){const[h,i]=c[d](g);e.innerHTML=h,f.innerHTML=i,a.appendChild(e),a.appendChild(f),b.appendChild(a)}})}function k(b){const a=document.getElementById('last-reports');a.innerHTML='',b.forEach(({message:e,sha:f})=>{const b=document.createElement('tr'),c=document.createElement('td'),d=document.createElement('td');c.innerHTML=e,d.innerHTML=`<a href="${window.location.href}?sha=${f}" target="_blank" rel="noopener noreferrer nofollow">See report</a>`,b.appendChild(c),b.appendChild(d),a.appendChild(b)})}function l(){const c=document.getElementById('newer'),d=document.getElementById('older');c.disabled=!0,c.addEventListener('click',async e=>{a-=1,await b(a),a===1&&(c.disabled=!0),d.disabled=!1}),d.addEventListener('click',async f=>{a+=1;const e=await b(a);e||(a-=1,d.disabled=!0),c.disabled=!1})}function h(d,b,e){const a=document.getElementById(d),c=document.createElement(b);Object.entries(e).forEach(([a,b])=>{c[a]=b}),a.querySelector(b)&&a.removeChild(a.querySelector(b)),a.appendChild(c)}function g(a,b){h('maps-folium','iframe',{src:b,title:c[a]})}function f(a,b){h('maps-gif','img',{src:b,alt:c[a]})}function p(e,a,b){const d=document.getElementById('variables-select');e.ncVariables.forEach((e,i)=>{const h=document.createElement('option');h.value=e,h.textContent=c[e],i===0&&(h.selected=!0,f(e,a[e]),g(e,b[e])),d.appendChild(h)}),d.addEventListener('change',d=>{const c=d.target.value;f(c,a[c]),g(c,b[c])})}async function q(){const{report:a,images:b,folium:c}=await m(o);return Object.keys(a).length>=7&&(p(a,b,c),i(a),!0)}async function b(){const b=await j(a);return b.length!==0&&(k(b),!0)}l(),await q()&&await b()&&n()}